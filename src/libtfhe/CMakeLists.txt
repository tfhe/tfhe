cmake_minimum_required(VERSION 3.0)

project(libtfhe)

# include the fft processors in the build process
add_subdirectory(fft_processors)

set(SRCS
    autogenerated.cpp
    lwebootstrappingkey.cpp
    lwe.cpp
    lwe-functions.cpp
    lwekey.cpp
    lwekeyswitch.cpp
    lweparams.cpp
    lwesamples.cpp
    multiplication.cpp
    numeric-functions.cpp
    polynomials.cpp
    tgsw.cpp
    tlwe.cpp
    tlwefftoperations.cpp
    toruspolynomial-functions.cpp
    boot-gates.cpp
    )

set(HEADERS
    ../include/tlwe.h
    ../include/lwesamples.h
    ../include/numeric_functions.h
    ../include/polynomials.h
    ../include/lweparams.h
    ../include/lagrangehalfc_arithmetic.h
    ../include/lwe-functions.h
    ../include/lwekeyswitch.h
    ../include/lwebootstrappingkey.h
    ../include/polynomials_arithmetic.h
    ../include/tlwe_functions.h
    ../include/tgsw_functions.h
    ../include/tfhe.h
    ../include/tgsw.h
    ../include/tfhe_core.h
    ../include/lwekey.h
    )

add_library(tfhe-core OBJECT ${SRCS} ${HEADERS})

if (ENABLE_FFTW) 
    add_library(tfhe-fftw $<TARGET_OBJECTS:tfhe-core> $<TARGET_OBJECTS:tfhe-fft-fftw>)
endif (ENABLE_FFTW) 

if (ENABLE_NAYUKI_AVX) 
    add_library(tfhe-nayuki-avx $<TARGET_OBJECTS:tfhe-core> $<TARGET_OBJECTS:tfhe-fft-nayuki-avx>)
endif (ENABLE_NAYUKI_AVX)

if (ENABLE_NAYUKI_PORTABLE) 
    add_library(tfhe-nayuki-portable $<TARGET_OBJECTS:tfhe-core> $<TARGET_OBJECTS:tfhe-fft-nayuki-portable>)
endif (ENABLE_NAYUKI_PORTABLE) 

if (ENABLE_SPQLIOS_AVX) 
    add_library(tfhe-spqlios-avx $<TARGET_OBJECTS:tfhe-core> $<TARGET_OBJECTS:tfhe-fft-spqlios-avx>)
endif (ENABLE_SPQLIOS_AVX) 

if (ENABLE_SPQLIOS_FMA) 
    add_library(tfhe-spqlios-fma $<TARGET_OBJECTS:tfhe-core> $<TARGET_OBJECTS:tfhe-fft-spqlios-fma>)
endif (ENABLE_SPQLIOS_FMA) 

